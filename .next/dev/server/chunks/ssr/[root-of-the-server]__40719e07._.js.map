{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/geist_a71539c9.module.css [app-rsc] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"className\": \"geist_a71539c9-module__T19VSG__className\",\n  \"variable\": \"geist_a71539c9-module__T19VSG__variable\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 11, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/geist_a71539c9.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/google/cssmodule.module.css?{%22path%22:%22layout.tsx%22,%22import%22:%22Geist%22,%22arguments%22:[{%22variable%22:%22--font-geist-sans%22,%22subsets%22:[%22latin%22]}],%22variableName%22:%22geistSans%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'Geist', 'Geist Fallback'\",\n        fontStyle: \"normal\",\n\n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;;AAAA;;AACA,MAAM,WAAW;IACb,WAAW,gKAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;QACZ,WAAW;IAEf;AACJ;AAEA,IAAI,gKAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,gKAAS,CAAC,QAAQ;AAC1C;uCAEe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/geist_mono_8d43a2aa.module.css [app-rsc] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"className\": \"geist_mono_8d43a2aa-module__8Li5zG__className\",\n  \"variable\": \"geist_mono_8d43a2aa-module__8Li5zG__variable\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/geist_mono_8d43a2aa.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/google/cssmodule.module.css?{%22path%22:%22layout.tsx%22,%22import%22:%22Geist_Mono%22,%22arguments%22:[{%22variable%22:%22--font-geist-mono%22,%22subsets%22:[%22latin%22]}],%22variableName%22:%22geistMono%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'Geist Mono', 'Geist Mono Fallback'\",\n        fontStyle: \"normal\",\n\n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;;AAAA;;AACA,MAAM,WAAW;IACb,WAAW,qKAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;QACZ,WAAW;IAEf;AACJ;AAEA,IAAI,qKAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,qKAAS,CAAC,QAAQ;AAC1C;uCAEe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Szymon/Desktop/bezpiesniowy/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined;\r\n};\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\r\n  });\r\n\r\nif (process.env.NODE_ENV !== \"production\") {\r\n  globalForPrisma.prisma = prisma;\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B","debugId":null}},
    {"offset": {"line": 105, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Szymon/Desktop/bezpiesniowy/src/lib/auth.ts"],"sourcesContent":["import bcrypt from \"bcryptjs\";\r\nimport jwt from \"jsonwebtoken\";\r\nimport { UserRole } from \"@prisma/client\";\r\nimport type { NextRequest } from \"next/server\";\r\n\r\nconst TOKEN_COOKIE = \"bezpiesniowy_token\";\r\n\r\nexport interface AuthTokenPayload {\r\n  userId: number;\r\n  email: string;\r\n  role: UserRole;\r\n}\r\n\r\nfunction getJwtSecret(): string {\r\n  const secret = process.env.JWT_SECRET;\r\n  if (!secret) {\r\n    throw new Error(\"JWT_SECRET must be set\");\r\n  }\r\n  return secret;\r\n}\r\n\r\nexport async function hashPassword(plain: string): Promise<string> {\r\n  return bcrypt.hash(plain, 10);\r\n}\r\n\r\nexport async function verifyPassword(plain: string, hash: string): Promise<boolean> {\r\n  return bcrypt.compare(plain, hash);\r\n}\r\n\r\nexport function signAuthToken(payload: AuthTokenPayload, expiresIn = \"7d\"): string {\r\n  return jwt.sign(payload, getJwtSecret(), { expiresIn });\r\n}\r\n\r\nexport function verifyAuthToken(token: string): AuthTokenPayload | null {\r\n  try {\r\n    return jwt.verify(token, getJwtSecret()) as AuthTokenPayload;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function extractTokenFromHeader(header?: string | null): string | null {\r\n  if (!header) {\r\n    return null;\r\n  }\r\n  const [type, token] = header.split(\" \");\r\n  if (type?.toLowerCase() !== \"bearer\" || !token) {\r\n    return null;\r\n  }\r\n  return token;\r\n}\r\n\r\nexport function getTokenFromCookies(request: NextRequest): string | null {\r\n  return request.cookies.get(TOKEN_COOKIE)?.value ?? null;\r\n}\r\n\r\nexport { TOKEN_COOKIE };\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AACA;;;AAIA,MAAM,eAAe;AAQrB,SAAS;IACP,MAAM,SAAS,QAAQ,GAAG,CAAC,UAAU;IACrC,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;AAEO,eAAe,aAAa,KAAa;IAC9C,OAAO,4IAAM,CAAC,IAAI,CAAC,OAAO;AAC5B;AAEO,eAAe,eAAe,KAAa,EAAE,IAAY;IAC9D,OAAO,4IAAM,CAAC,OAAO,CAAC,OAAO;AAC/B;AAEO,SAAS,cAAc,OAAyB,EAAE,YAAY,IAAI;IACvE,OAAO,gJAAG,CAAC,IAAI,CAAC,SAAS,gBAAgB;QAAE;IAAU;AACvD;AAEO,SAAS,gBAAgB,KAAa;IAC3C,IAAI;QACF,OAAO,gJAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,SAAS,uBAAuB,MAAsB;IAC3D,IAAI,CAAC,QAAQ;QACX,OAAO;IACT;IACA,MAAM,CAAC,MAAM,MAAM,GAAG,OAAO,KAAK,CAAC;IACnC,IAAI,MAAM,kBAAkB,YAAY,CAAC,OAAO;QAC9C,OAAO;IACT;IACA,OAAO;AACT;AAEO,SAAS,oBAAoB,OAAoB;IACtD,OAAO,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe,SAAS;AACrD","debugId":null}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Szymon/Desktop/bezpiesniowy/src/lib/server-auth.ts"],"sourcesContent":["import type { NextRequest } from \"next/server\";\r\nimport jwt from \"jsonwebtoken\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { TOKEN_COOKIE, extractTokenFromHeader, getTokenFromCookies, verifyAuthToken } from \"@/lib/auth\";\r\n\r\nexport async function getUserFromRequest(request: NextRequest) {\r\n  const headerToken = extractTokenFromHeader(request.headers.get(\"authorization\"));\r\n  const cookieToken = getTokenFromCookies(request);\r\n  const token = headerToken ?? cookieToken;\r\n\r\n  if (!token) return null;\r\n  const payload = verifyAuthToken(token);\r\n  if (!payload) return null;\r\n\r\n  return prisma.user.findUnique({\r\n    where: { id: payload.userId },\r\n  });\r\n}\r\n\r\nexport async function requireAdmin(request: NextRequest) {\r\n  const user = await getUserFromRequest(request);\r\n  if (!user || user.role !== \"ADMIN\") {\r\n    return null;\r\n  }\r\n  return user;\r\n}\r\n\r\n// З uniwersalna wersja getCurrentUserFromCookies\r\nexport async function getCurrentUserFromCookies(req?: any) {\r\n  let token: string | undefined;\r\n\r\n  try {\r\n    // Pr贸ba u偶ycia App Router API\r\n    const { cookies } = await import(\"next/headers\");\r\n    // `cookies()` is async in this Next.js runtime and must be awaited\r\n    const cookieStore = await cookies();\r\n    token = cookieStore.get(TOKEN_COOKIE)?.value;\r\n  } catch {\r\n    // Fallback dla Pages Router (req.cookies)\r\n    token = req?.cookies?.[TOKEN_COOKIE];\r\n  }\r\n\r\n  if (!token) return null;\r\n\r\n  const payload = verifyAuthToken(token);\r\n  if (!payload) return null;\r\n\r\n  return prisma.user.findUnique({\r\n    where: { id: payload.userId },\r\n  });\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAEA;AACA;;;AAEO,eAAe,mBAAmB,OAAoB;IAC3D,MAAM,cAAc,IAAA,4IAAsB,EAAC,QAAQ,OAAO,CAAC,GAAG,CAAC;IAC/D,MAAM,cAAc,IAAA,yIAAmB,EAAC;IACxC,MAAM,QAAQ,eAAe;IAE7B,IAAI,CAAC,OAAO,OAAO;IACnB,MAAM,UAAU,IAAA,qIAAe,EAAC;IAChC,IAAI,CAAC,SAAS,OAAO;IAErB,OAAO,8HAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QAC5B,OAAO;YAAE,IAAI,QAAQ,MAAM;QAAC;IAC9B;AACF;AAEO,eAAe,aAAa,OAAoB;IACrD,MAAM,OAAO,MAAM,mBAAmB;IACtC,IAAI,CAAC,QAAQ,KAAK,IAAI,KAAK,SAAS;QAClC,OAAO;IACT;IACA,OAAO;AACT;AAGO,eAAe,0BAA0B,GAAS;IACvD,IAAI;IAEJ,IAAI;QACF,8BAA8B;QAC9B,MAAM,EAAE,OAAO,EAAE,GAAG;QACpB,mEAAmE;QACnE,MAAM,cAAc,MAAM;QAC1B,QAAQ,YAAY,GAAG,CAAC,kIAAY,GAAG;IACzC,EAAE,OAAM;QACN,0CAA0C;QAC1C,QAAQ,KAAK,SAAS,CAAC,kIAAY,CAAC;IACtC;IAEA,IAAI,CAAC,OAAO,OAAO;IAEnB,MAAM,UAAU,IAAA,qIAAe,EAAC;IAChC,IAAI,CAAC,SAAS,OAAO;IAErB,OAAO,8HAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QAC5B,OAAO;YAAE,IAAI,QAAQ,MAAM;QAAC;IAC9B;AACF","debugId":null}},
    {"offset": {"line": 226, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Szymon/Desktop/bezpiesniowy/src/components/LogoutButton.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const LogoutButton = registerClientReference(\n    function() { throw new Error(\"Attempted to call LogoutButton() from the server but LogoutButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/LogoutButton.tsx <module evaluation>\",\n    \"LogoutButton\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,eAAe,IAAA,wQAAuB,EAC/C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,iEACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 240, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Szymon/Desktop/bezpiesniowy/src/components/LogoutButton.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const LogoutButton = registerClientReference(\n    function() { throw new Error(\"Attempted to call LogoutButton() from the server but LogoutButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/LogoutButton.tsx\",\n    \"LogoutButton\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,eAAe,IAAA,wQAAuB,EAC/C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,6CACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 254, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 262, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Szymon/Desktop/bezpiesniowy/src/app/layout.tsx"],"sourcesContent":["import type { Metadata } from \"next\";\nimport Link from \"next/link\";\nimport { Geist, Geist_Mono } from \"next/font/google\";\nimport \"./globals.css\";\nimport { getCurrentUserFromCookies } from \"@/lib/server-auth\";\nimport { LogoutButton } from \"@/components/LogoutButton\";\n\nconst geistSans = Geist({\n  variable: \"--font-geist-sans\",\n  subsets: [\"latin\"],\n});\n\nconst geistMono = Geist_Mono({\n  variable: \"--font-geist-mono\",\n  subsets: [\"latin\"],\n});\n\nexport const metadata: Metadata = {\n  title: \"Bezpieniowy 路 Zgadnij polsk piosenk\",\n  description:\n    \"Bezpieniowy to quiz muzyczny, w kt贸rym zgadujesz polskie piosenki po kr贸tkich fragmentach audio. Wasna baza MP3, lokalne odtwarzanie, panel administracyjny i JWT auth.\",\n};\n\nexport default async function RootLayout({\n  children,\n}: Readonly<{\n  children: React.ReactNode;\n}>) {\n  const user = await getCurrentUserFromCookies();\n\n  return (\n    <html lang=\"pl\" className={`${geistSans.variable} ${geistMono.variable}`}>\n      <body className=\"min-h-screen bg-slate-950/95 text-slate-100 antialiased\">\n        <div className=\"relative isolate flex min-h-screen flex-col\">\n          <header className=\"sticky top-0 z-40 border-b border-white/10 bg-slate-950/70 backdrop-blur\">\n            <div className=\"mx-auto flex w-full max-w-6xl items-center justify-between px-4 py-4 sm:px-6 lg:px-8\">\n              <Link href=\"/\" className=\"flex items-center gap-2 text-lg font-semibold tracking-tight text-white\">\n                <span className=\"inline-flex h-9 w-9 items-center justify-center rounded-full bg-emerald-500 text-base font-bold text-white shadow-lg\">\n                  B\n                </span>\n                <span>Bezpieniowy</span>\n              </Link>\n              <nav className=\"flex items-center gap-4 text-sm font-medium text-slate-200\">\n                <Link href=\"/\" className=\"transition hover:text-white\">\n                  Gra\n                </Link>\n                <Link href=\"/admin\" className=\"transition hover:text-white\">\n                  Panel admina\n                </Link>\n                {!user && (\n                  <Link\n                    href=\"/login\"\n                    className=\"rounded-full border border-emerald-400 px-4 py-1.5 text-emerald-300 transition hover:bg-emerald-500/10\"\n                  >\n                    Zaloguj si\n                  </Link>\n                )}\n                {user && (\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"hidden text-xs text-slate-400 sm:block\">\n                      {user.email} {user.role === \"ADMIN\" ? \"(admin)\" : \"\"}\n                    </span>\n                    <LogoutButton />\n                  </div>\n                )}\n              </nav>\n            </div>\n          </header>\n          <main className=\"flex-1 bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 pb-16\">\n            {children}\n          </main>\n          <footer className=\"border-t border-white/10 bg-slate-950/80 py-6 text-sm text-slate-400\">\n            <div className=\"mx-auto flex w-full max-w-6xl flex-col gap-2 px-4 sm:flex-row sm:items-center sm:justify-between sm:px-6 lg:px-8\">\n              <p>漏 {new Date().getFullYear()} Bezpieniowy. Projekt edukacyjny.</p>\n              <p>\n                Pamitaj o prawach autorskich. Wgrywaj jedynie pliki, do kt贸rych masz uprawnienia\n                licencyjne.\n              </p>\n            </div>\n          </footer>\n        </div>\n      </body>\n    </html>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AACA;;;AAGA;AACA;;;;;;;;AAYO,MAAM,WAAqB;IAChC,OAAO;IACP,aACE;AACJ;AAEe,eAAe,WAAW,EACvC,QAAQ,EAGR;IACA,MAAM,OAAO,MAAM,IAAA,yJAAyB;IAE5C,qBACE,8OAAC;QAAK,MAAK;QAAK,WAAW,GAAG,oJAAS,CAAC,QAAQ,CAAC,CAAC,EAAE,yJAAS,CAAC,QAAQ,EAAE;kBACtE,cAAA,8OAAC;YAAK,WAAU;sBACd,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAO,WAAU;kCAChB,cAAA,8OAAC;4BAAI,WAAU;;8CACb,8OAAC,0LAAI;oCAAC,MAAK;oCAAI,WAAU;;sDACvB,8OAAC;4CAAK,WAAU;sDAAuH;;;;;;sDAGvI,8OAAC;sDAAK;;;;;;;;;;;;8CAER,8OAAC;oCAAI,WAAU;;sDACb,8OAAC,0LAAI;4CAAC,MAAK;4CAAI,WAAU;sDAA8B;;;;;;sDAGvD,8OAAC,0LAAI;4CAAC,MAAK;4CAAS,WAAU;sDAA8B;;;;;;wCAG3D,CAAC,sBACA,8OAAC,0LAAI;4CACH,MAAK;4CACL,WAAU;sDACX;;;;;;wCAIF,sBACC,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAK,WAAU;;wDACb,KAAK,KAAK;wDAAC;wDAAE,KAAK,IAAI,KAAK,UAAU,YAAY;;;;;;;8DAEpD,8OAAC,kJAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAMvB,8OAAC;wBAAK,WAAU;kCACb;;;;;;kCAEH,8OAAC;wBAAO,WAAU;kCAChB,cAAA,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;;wCAAE;wCAAG,IAAI,OAAO,WAAW;wCAAG;;;;;;;8CAC/B,8OAAC;8CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUjB","debugId":null}}]
}
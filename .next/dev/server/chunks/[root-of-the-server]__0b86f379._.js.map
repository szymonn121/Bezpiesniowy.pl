{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Szymon/Desktop/bezpiesniowy/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined;\r\n};\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\r\n  });\r\n\r\nif (process.env.NODE_ENV !== \"production\") {\r\n  globalForPrisma.prisma = prisma;\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B","debugId":null}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Szymon/Desktop/bezpiesniowy/src/lib/game.ts"],"sourcesContent":["export const SNIPPET_DURATIONS_SECONDS = [0.5, 1, 2, 5, 10] as const;\r\n\r\nexport const STAGE_SCORES = [10, 8, 6, 4, 2] as const;\r\n\r\nexport function scoreForStage(stageIndex: number, attempts: number): number {\r\n  const base = STAGE_SCORES[Math.min(stageIndex, STAGE_SCORES.length - 1)];\r\n  const penalty = Math.max(attempts - 1, 0);\r\n  return Math.max(base - penalty, 0);\r\n}\r\n\r\nexport function normalizeAnswer(answer: string): string {\r\n  return answer\r\n    .trim()\r\n    .toLowerCase()\r\n    .normalize(\"NFD\")\r\n    .replace(/ł/g, \"l\")\r\n    .replace(/Ł/g, \"l\")\r\n    .replace(/[\\u0300-\\u036f]/g, \"\")\r\n    .replace(/[^a-z0-9 ]/g, \"\")\r\n    .replace(/\\s+/g, \" \")\r\n    .trim();\r\n}\r\n\r\nexport function buildAcceptableAnswers(title: string, artist: string): string[] {\r\n  const normalizedTitle = normalizeAnswer(title);\r\n  const normalizedArtist = normalizeAnswer(artist);\r\n\r\n  const combos = [\r\n    normalizedTitle,\r\n    `${normalizedArtist} ${normalizedTitle}`.trim(),\r\n    `${normalizedTitle} ${normalizedArtist}`.trim(),\r\n    `${normalizedArtist}-${normalizedTitle}`.trim(),\r\n    `${normalizedTitle}-${normalizedArtist}`.trim(),\r\n  ];\r\n\r\n  return Array.from(new Set(combos.map(normalizeAnswer)));\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAO,MAAM,4BAA4B;IAAC;IAAK;IAAG;IAAG;IAAG;CAAG;AAEpD,MAAM,eAAe;IAAC;IAAI;IAAG;IAAG;IAAG;CAAE;AAErC,SAAS,cAAc,UAAkB,EAAE,QAAgB;IAChE,MAAM,OAAO,YAAY,CAAC,KAAK,GAAG,CAAC,YAAY,aAAa,MAAM,GAAG,GAAG;IACxE,MAAM,UAAU,KAAK,GAAG,CAAC,WAAW,GAAG;IACvC,OAAO,KAAK,GAAG,CAAC,OAAO,SAAS;AAClC;AAEO,SAAS,gBAAgB,MAAc;IAC5C,OAAO,OACJ,IAAI,GACJ,WAAW,GACX,SAAS,CAAC,OACV,OAAO,CAAC,MAAM,KACd,OAAO,CAAC,MAAM,KACd,OAAO,CAAC,oBAAoB,IAC5B,OAAO,CAAC,eAAe,IACvB,OAAO,CAAC,QAAQ,KAChB,IAAI;AACT;AAEO,SAAS,uBAAuB,KAAa,EAAE,MAAc;IAClE,MAAM,kBAAkB,gBAAgB;IACxC,MAAM,mBAAmB,gBAAgB;IAEzC,MAAM,SAAS;QACb;QACA,GAAG,iBAAiB,CAAC,EAAE,iBAAiB,CAAC,IAAI;QAC7C,GAAG,gBAAgB,CAAC,EAAE,kBAAkB,CAAC,IAAI;QAC7C,GAAG,iBAAiB,CAAC,EAAE,iBAAiB,CAAC,IAAI;QAC7C,GAAG,gBAAgB,CAAC,EAAE,kBAAkB,CAAC,IAAI;KAC9C;IAED,OAAO,MAAM,IAAI,CAAC,IAAI,IAAI,OAAO,GAAG,CAAC;AACvC","debugId":null}},
    {"offset": {"line": 123, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Szymon/Desktop/bezpiesniowy/src/app/api/songs/random/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { SNIPPET_DURATIONS_SECONDS } from \"@/lib/game\";\r\n\r\nexport async function GET() {\r\n  const total = await prisma.song.count();\r\n\r\n  if (total === 0) {\r\n    return NextResponse.json({ message: \"Brak piosenek w bazie\" }, { status: 404 });\r\n  }\r\n\r\n  const randomIndex = Math.floor(Math.random() * total);\r\n\r\n  const song = await prisma.song.findFirst({\r\n    skip: randomIndex,\r\n    orderBy: { id: \"asc\" },\r\n  });\r\n\r\n  if (!song) {\r\n    return NextResponse.json({ message: \"Nie udało się wylosować piosenki\" }, { status: 500 });\r\n  }\r\n\r\n  const audioUrl = `/audio/${song.fileName}`;\r\n  const hints = buildHints(song);\r\n\r\n  return NextResponse.json({\r\n    // include title/artist so client can reveal the answer when user skips\r\n    title: song.title,\r\n    artist: song.artist,\r\n    songId: song.id,\r\n    audioUrl,\r\n    hints,\r\n    snippetDurations: SNIPPET_DURATIONS_SECONDS,\r\n  });\r\n}\r\n\r\nfunction buildHints(song: {\r\n  title: string;\r\n  artist: string;\r\n  genre: string | null;\r\n  year: number | null;\r\n}) {\r\n  const hints = [];\r\n\r\n  if (song.genre) {\r\n    hints.push({ stage: 1, label: \"Gatunek\", value: song.genre });\r\n  }\r\n\r\n  if (song.year) {\r\n    hints.push({ stage: 2, label: \"Rok wydania\", value: String(song.year) });\r\n  }\r\n\r\n  if (song.title) {\r\n    hints.push({\r\n      stage: 3,\r\n      label: \"Tytuł - pierwsza litera\",\r\n      value: `${song.title[0]?.toUpperCase() ?? \"?\"}…`,\r\n    });\r\n  }\r\n\r\n  if (song.artist) {\r\n    hints.push({\r\n      stage: 4,\r\n      label: \"Wykonawca - pierwsza litera\",\r\n      value: `${song.artist[0]?.toUpperCase() ?? \"?\"}…`,\r\n    });\r\n  }\r\n\r\n  return hints;\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe;IACpB,MAAM,QAAQ,MAAM,gIAAM,CAAC,IAAI,CAAC,KAAK;IAErC,IAAI,UAAU,GAAG;QACf,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC/E;IAEA,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK;IAE/C,MAAM,OAAO,MAAM,gIAAM,CAAC,IAAI,CAAC,SAAS,CAAC;QACvC,MAAM;QACN,SAAS;YAAE,IAAI;QAAM;IACvB;IAEA,IAAI,CAAC,MAAM;QACT,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAmC,GAAG;YAAE,QAAQ;QAAI;IAC1F;IAEA,MAAM,WAAW,CAAC,OAAO,EAAE,KAAK,QAAQ,EAAE;IAC1C,MAAM,QAAQ,WAAW;IAEzB,OAAO,gJAAY,CAAC,IAAI,CAAC;QACvB,uEAAuE;QACvE,OAAO,KAAK,KAAK;QACjB,QAAQ,KAAK,MAAM;QACnB,QAAQ,KAAK,EAAE;QACf;QACA;QACA,kBAAkB,iJAAyB;IAC7C;AACF;AAEA,SAAS,WAAW,IAKnB;IACC,MAAM,QAAQ,EAAE;IAEhB,IAAI,KAAK,KAAK,EAAE;QACd,MAAM,IAAI,CAAC;YAAE,OAAO;YAAG,OAAO;YAAW,OAAO,KAAK,KAAK;QAAC;IAC7D;IAEA,IAAI,KAAK,IAAI,EAAE;QACb,MAAM,IAAI,CAAC;YAAE,OAAO;YAAG,OAAO;YAAe,OAAO,OAAO,KAAK,IAAI;QAAE;IACxE;IAEA,IAAI,KAAK,KAAK,EAAE;QACd,MAAM,IAAI,CAAC;YACT,OAAO;YACP,OAAO;YACP,OAAO,GAAG,KAAK,KAAK,CAAC,EAAE,EAAE,iBAAiB,IAAI,CAAC,CAAC;QAClD;IACF;IAEA,IAAI,KAAK,MAAM,EAAE;QACf,MAAM,IAAI,CAAC;YACT,OAAO;YACP,OAAO;YACP,OAAO,GAAG,KAAK,MAAM,CAAC,EAAE,EAAE,iBAAiB,IAAI,CAAC,CAAC;QACnD;IACF;IAEA,OAAO;AACT","debugId":null}}]
}